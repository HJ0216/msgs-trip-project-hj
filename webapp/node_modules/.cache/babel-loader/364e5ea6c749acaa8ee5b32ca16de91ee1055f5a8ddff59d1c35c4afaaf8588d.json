{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from \"axios\";\nimport React, { useState, useEffect } from \"react\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst KaKaoCallback = () => {\n  _s();\n  const [kakaoEmail, setKakaoEmail] = useState('');\n  useEffect(() => {\n    const params = new URL(document.location.toString()).searchParams;\n    const code = params.get(\"code\");\n    const grantType = \"authorization_code\";\n    const REST_API_KEY = `${process.env.REACT_APP_PUBLIC_REST_API_KEY}`;\n    const REDIRECT_URI = `${process.env.REACT_APP_REDIRECT_KAKAO_URL}`;\n    axios.post(`https://kauth.kakao.com/oauth/token?grant_type=${grantType}&client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}&code=${code}`, {}, {\n      headers: {\n        \"Content-type\": \"application/x-www-form-urlencoded;charset=utf-8\"\n      }\n    }).then(function (res) {\n      console.log(res);\n      const {\n        data\n      } = res;\n      const {\n        access_token\n      } = data;\n      axios.post(\"https://kapi.kakao.com/v2/user/me\", {}, {\n        headers: {\n          Authorization: `Bearer ${access_token}`,\n          \"Content-type\": \"application/x-www-form-urlencoded\"\n        }\n      }).then(function (res) {\n        console.log(\"데이터 성공\", res);\n        setKakaoEmail(res.data.kakao_account.email);\n\n        // fetch(\"/user/kakaologin\", {\n        //     method: \"post\",\n        //     body: JSON.stringify({\n        //         email: res.data.kakao_account.email,\n        //         type: \"k\",\n        //     }),\n        // })\n        //     .then((response) => response.json())\n        //     .then((res) => console.log(res));\n      });\n    }).catch(function (Error) {\n      console.log(\"ERR\", Error);\n    });\n  }, []);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        // 비동기 작업 수행\n        const response = await fetch(`/user/getUserInfo?email=${kakaoEmail}`, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            email: kakaoEmail\n          })\n        });\n\n        // 처리 코드\n        if (response.ok) {\n          const text = await response.text();\n          // ...\n        } else {\n          // ...\n        }\n      } catch (err) {\n        // 에러 처리\n        console.log(\"서버 통신 에러 발생: \" + err);\n      }\n    };\n    fetchData();\n  }, [kakaoEmail]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n};\n_s(KaKaoCallback, \"rC419dLi70tlH/KhrmwXclr5fNs=\");\n_c = KaKaoCallback;\nexport default KaKaoCallback;\nvar _c;\n$RefreshReg$(_c, \"KaKaoCallback\");","map":{"version":3,"names":["axios","React","useState","useEffect","Fragment","_Fragment","jsxDEV","_jsxDEV","KaKaoCallback","_s","kakaoEmail","setKakaoEmail","params","URL","document","location","toString","searchParams","code","get","grantType","REST_API_KEY","process","env","REACT_APP_PUBLIC_REST_API_KEY","REDIRECT_URI","REACT_APP_REDIRECT_KAKAO_URL","post","headers","then","res","console","log","data","access_token","Authorization","kakao_account","email","catch","Error","fetchData","response","fetch","method","body","JSON","stringify","ok","text","err","_c","$RefreshReg$"],"sources":["C:/MSGS/MSGS/src/main/webapp/src/components/login/KaKaoCallback.js"],"sourcesContent":["import axios from \"axios\";\r\nimport React, { useState, useEffect } from \"react\";\r\n\r\nconst KaKaoCallback = () => {\r\n    const [kakaoEmail, setKakaoEmail] = useState('');\r\n\r\n    useEffect(() => {\r\n        const params = new URL(document.location.toString()).searchParams;\r\n        const code = params.get(\"code\");\r\n        const grantType = \"authorization_code\";\r\n        const REST_API_KEY = `${process.env.REACT_APP_PUBLIC_REST_API_KEY}`;\r\n        const REDIRECT_URI = `${process.env.REACT_APP_REDIRECT_KAKAO_URL}`;\r\n\r\n        axios\r\n            .post(\r\n                `https://kauth.kakao.com/oauth/token?grant_type=${grantType}&client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}&code=${code}`,\r\n                {},\r\n                {\r\n                    headers: {\r\n                        \"Content-type\":\r\n                            \"application/x-www-form-urlencoded;charset=utf-8\",\r\n                    },\r\n                }\r\n            )\r\n            .then(function (res) {\r\n                console.log(res);\r\n                const { data } = res;\r\n                const { access_token } = data;\r\n                axios\r\n                    .post(\r\n                        \"https://kapi.kakao.com/v2/user/me\",\r\n                        {},\r\n                        {\r\n                            headers: {\r\n                                Authorization: `Bearer ${access_token}`,\r\n                                \"Content-type\":\r\n                                    \"application/x-www-form-urlencoded\",\r\n                            },\r\n                        }\r\n                    )\r\n                    .then(function (res) {\r\n                        console.log(\"데이터 성공\", res);\r\n                        setKakaoEmail(res.data.kakao_account.email);\r\n\r\n                        // fetch(\"/user/kakaologin\", {\r\n                        //     method: \"post\",\r\n                        //     body: JSON.stringify({\r\n                        //         email: res.data.kakao_account.email,\r\n                        //         type: \"k\",\r\n                        //     }),\r\n                        // })\r\n                        //     .then((response) => response.json())\r\n                        //     .then((res) => console.log(res));\r\n                    });\r\n            })\r\n            .catch(function (Error) {\r\n                console.log(\"ERR\", Error);\r\n            });\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n          try {\r\n            // 비동기 작업 수행\r\n            const response = await fetch(`/user/getUserInfo?email=${kakaoEmail}`, {\r\n              method: \"POST\",\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n              },\r\n              body: JSON.stringify({ email: kakaoEmail }),\r\n            });\r\n      \r\n            // 처리 코드\r\n            if (response.ok) {\r\n              const text = await response.text();\r\n              // ...\r\n            } else {\r\n              // ...\r\n            }\r\n          } catch (err) {\r\n            // 에러 처리\r\n            console.log(\"서버 통신 에러 발생: \" + err);\r\n          }\r\n        };\r\n      \r\n        fetchData();\r\n      }, [kakaoEmail]);\r\n\r\n    return <></>;\r\n};\r\n\r\nexport default KaKaoCallback;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}